/**
 * Table Mixins - Shared table styles for responsive container behavior
 * 
 * These mixins ensure tables don't overflow their containers when the left menu is expanded/collapsed
 * and provide resizable column functionality with proportional redistribution.
 */

// Mixin for table container wrapper
@mixin table-container-wrapper {
  width: 100%;
  max-width: 100%;
  overflow: hidden;
  box-sizing: border-box;

  :global {
    .ant-table-wrapper {
      width: 100% !important;
      max-width: 100% !important;
    }

    .ant-table {
      width: 100% !important;
      max-width: 100% !important;
      table-layout: fixed !important; // Fixed layout for proportional columns
    }

    .ant-table-container {
      width: 100% !important;
      max-width: 100% !important;
    }

    .ant-table-content {
      width: 100% !important;
      max-width: 100% !important;
      overflow-x: auto !important; // Allow horizontal scroll if needed
    }

    .ant-table-body {
      overflow-x: auto !important;
      overflow-y: auto !important;
    }
  }
}

// Mixin for page-level container
@mixin page-container {
  width: 100%;
  max-width: 100%;
  overflow: hidden;
  box-sizing: border-box;
}

// Mixin for flex table wrapper (when table is in a flex container)
@mixin flex-table-wrapper {
  flex: 1;
  min-width: 0; // Allow flex item to shrink below content size
  max-width: 100%;
  overflow: hidden;

  &.full {
    flex: 2;
  }
}

// Mixin for report table section (flex container with table and other elements)
@mixin report-table-section {
  display: flex;
  gap: 20px;
  width: 100%;
  max-width: 100%;
  overflow: hidden;
}

// Mixin for resizable columns (import react-resizable styles)
@mixin resizable-columns {
  @import 'react-resizable/css/styles.css';

  :global {
    .ant-table-thead > tr > th {
      position: relative !important;
    }

    .react-resizable {
      position: relative;
      background-clip: padding-box;
    }

    .react-resizable-handle {
      position: absolute !important;
      right: -5px !important;
      bottom: 0 !important;
      z-index: 10 !important;
      width: 10px !important;
      height: 100% !important;
      cursor: col-resize !important;
      background: transparent !important;

      &::before {
        content: '' !important;
        display: block !important;
        position: absolute !important;
        right: 4px !important;
        top: 0 !important;
        width: 2px !important;
        height: 100% !important;
        background-color: rgba(255, 255, 255, 0.2) !important;
        transition: background-color 0.2s !important;
      }

      &:hover::before {
        background-color: rgba(0, 212, 170, 0.8) !important;
      }
    }

    .react-resizable-handle-se {
      right: -5px !important;
      bottom: 0 !important;
      cursor: col-resize !important;
    }
  }
}

// Mixin for Select dropdown with full-width items (no text truncation)
@mixin select-dropdown-full-width {
  :global {
    .ant-select-item {
      white-space: normal !important;
      word-wrap: break-word !important;
      word-break: break-word !important;
      height: auto !important;
      min-height: 32px !important;
      padding: 5px 12px !important;
      line-height: 1.5 !important;
    }

    .ant-select-item-option-content {
      white-space: normal !important;
      word-wrap: break-word !important;
      word-break: break-word !important;
    }
  }
}

// Mixin for fixed columns with background (prevents text overlap on scroll)
@mixin fixed-columns-background {
  // Dark theme
  [data-theme="dark"] & {
    .ant-table-wrapper {
      // Fixed left columns in body - add solid background
      .ant-table-tbody {
        .ant-table-cell-fix-left,
        .ant-table-cell-fix-left-last {
          background: #1E2A3A !important;
          z-index: 2 !important;

          &::after {
            box-shadow: inset 10px 0 8px -8px rgba(0, 0, 0, 0.5) !important;
          }
        }

        .ant-table-cell-fix-right,
        .ant-table-cell-fix-right-first {
          background: #1E2A3A !important;
          z-index: 2 !important;

          &::before {
            box-shadow: inset -10px 0 8px -8px rgba(0, 0, 0, 0.5) !important;
          }
        }
      }

      // Fixed columns in header
      .ant-table-thead {
        .ant-table-cell-fix-left,
        .ant-table-cell-fix-left-last {
          background: #243142 !important;
          z-index: 3 !important;

          &::after {
            box-shadow: inset 10px 0 8px -8px rgba(0, 0, 0, 0.5) !important;
          }
        }

        .ant-table-cell-fix-right,
        .ant-table-cell-fix-right-first {
          background: #243142 !important;
          z-index: 3 !important;

          &::before {
            box-shadow: inset -10px 0 8px -8px rgba(0, 0, 0, 0.5) !important;
          }
        }
      }

      // Hover state for rows with fixed columns
      .ant-table-tbody > tr:hover {
        > .ant-table-cell-fix-left,
        > .ant-table-cell-fix-left-last,
        > .ant-table-cell-fix-right,
        > .ant-table-cell-fix-right-first {
          background: rgba(0, 212, 170, 0.1) !important;
        }
      }
    }
  }

  // Light theme
  [data-theme="light"] & {
    .ant-table-wrapper {
      // Fixed left columns in body - add solid background
      .ant-table-tbody {
        .ant-table-cell-fix-left,
        .ant-table-cell-fix-left-last {
          background: #FFFFFF !important;
          z-index: 2 !important;

          &::after {
            box-shadow: inset 10px 0 8px -8px rgba(0, 0, 0, 0.15) !important;
          }
        }

        .ant-table-cell-fix-right,
        .ant-table-cell-fix-right-first {
          background: #FFFFFF !important;
          z-index: 2 !important;

          &::before {
            box-shadow: inset -10px 0 8px -8px rgba(0, 0, 0, 0.15) !important;
          }
        }
      }

      // Fixed columns in header
      .ant-table-thead {
        .ant-table-cell-fix-left,
        .ant-table-cell-fix-left-last {
          background: var(--refine-bg-tertiary) !important;
          z-index: 3 !important;

          &::after {
            box-shadow: inset 10px 0 8px -8px rgba(0, 0, 0, 0.15) !important;
          }
        }

        .ant-table-cell-fix-right,
        .ant-table-cell-fix-right-first {
          background: var(--refine-bg-tertiary) !important;
          z-index: 3 !important;

          &::before {
            box-shadow: inset -10px 0 8px -8px rgba(0, 0, 0, 0.15) !important;
          }
        }
      }

      // Hover state for rows with fixed columns
      .ant-table-tbody > tr:hover {
        > .ant-table-cell-fix-left,
        > .ant-table-cell-fix-left-last,
        > .ant-table-cell-fix-right,
        > .ant-table-cell-fix-right-first {
          background: rgba(0, 212, 170, 0.05) !important;
        }
      }
    }
  }
}

